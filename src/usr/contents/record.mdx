---
title: "Record Example"
date: "2023-10-01"
slug: "record"
description: ""
---

import { Record, RecordContext } from "../../modules/record/record";
import ArrowMapWithTimeBar from "../../modules/maps/leaflet/ArrowMapWithTimeBar";

export const MDXLayout = ({ children }) => <>{children}</>;

<Record search={{ tb: "persone" }}>
  <RecordContext.Consumer>
    {recordData => {
      if (!recordData || Object.keys(recordData).length === 0) {
        return <p>No data.</p>;
      }

      const persona = recordData || {};
      const spostamenti = recordData.luoghi_associati_alla_persona || [];

      const markers = spostamenti
        .filter(spostamento => spostamento.f_luoghi_id && spostamento.f_luoghi_id.coordinate)
        .map(spostamento => ({
          lat: spostamento.f_luoghi_id.coordinate.coordinates[1],
          lng: spostamento.f_luoghi_id.coordinate.coordinates[0],
          popup: spostamento.f_luoghi_id.nome_localita || "Luogo sconosciuto",
          prima_attestazione_anno: spostamento.prima_attestazione_anno || null,
          ultima_attestazione_anno: spostamento.ultima_attestazione_anno || null,
          residente: spostamento.residente || false,
          spostato_in_qualita_di: spostamento.spostato_in_qualita_di || "N/A",
          note_sullo_spostamento: spostamento.note_sullo_spostamento || "",
          fonte: spostamento.fonte || "",
        }));

      const sortedSpostamenti = [...spostamenti].sort(
        (a, b) => (a.prima_attestazione_anno || Infinity) - (b.prima_attestazione_anno || Infinity)
      );

      // Funzione per formattare la data in gg/mm/aa
      const formatDate = (dateString) => {
        if (!dateString) return null;
        const date = new Date(dateString);
        if (isNaN(date.getTime())) return null;
        
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear().toString().slice(-2);
        
        return `${day}/${month}/${year}`;
      };

      return (
        <div style={{ display: "flex", flexDirection: "row", gap: "16px" }}>
          <div style={{ flex: 8, paddingRight: "16px" }}>
            <ArrowMapWithTimeBar height="600px" baseLayers={["OSM"]} markers={markers} />
          </div>

          <div
            style={{
              flex: 4,
              padding: "20px",
              backgroundColor: "#f8f8f8",
              border: "1px solid #ddd",
              borderRadius: "10px",
              boxShadow: "0 2px 5px rgba(0, 0, 0, 0.1)",
              overflowY: "auto",
              maxHeight: "600px",
            }}
          >
            <div
              style={{
                backgroundColor: "#aa1a10",
                padding: "16px",
                borderRadius: "10px",
                textAlign: "center",
                marginBottom: "20px",
                color: "#fff",
                fontFamily: "'Arial', sans-serif",
                width: "100%",
              }}
            >
              <h1 style={{ marginBottom: "8px", fontSize: "22px", fontWeight: "bold" }}>
                {persona.nome_e_cognome || "Nome sconosciuto"} -{" "}
                <span style={{ fontWeight: "normal" }}>
                  {persona.professione || "Senza professione"}
                </span>
              </h1>
              {persona.Pseudonimo && (
                <h2 style={{ fontSize: "16px", fontStyle: "italic" }}>
                  (also mentioned as {persona.Pseudonimo})
                </h2>
              )}
              {persona.note_sul_personaggio && (
                <p style={{ marginTop: "12px" }}>
                  <strong>Note:</strong>{" "}
                  <span dangerouslySetInnerHTML={{ __html: persona.note_sul_personaggio }} />
                </p>
              )}
            </div>

            <div>
              <h3 style={{ textAlign: "center", marginBottom: "16px" }}>Attested in:</h3>
              {sortedSpostamenti.map((spostamento, index) => {
                const primaData = formatDate(spostamento.prima_attestazione_data);
                const ultimaData = formatDate(spostamento.ultima_attestazione_data);
                const showDates = primaData || ultimaData;
                
                return (
                  <div
                    key={index}
                    style={{
                      marginBottom: "24px",
                      padding: "12px",
                      borderRadius: "10px",
                      backgroundColor: "#f9f9f9",
                      textAlign: "center",
                      boxShadow: "0 2px 6px rgba(0, 0, 0, 0.15)",
                      width: "100%",
                      maxWidth: "500px",
                    }}
                  >
                    <h3 style={{
                        fontSize: "18px",
                        fontWeight: "bold",
                        color: "#aa1a10",
                        marginBottom: "10px"
                    }}>
                      {spostamento.f_luoghi_id.nome_localita}{" "}
                      {spostamento.prima_attestazione_anno && (
                        <>
                          (
                          {spostamento.prima_attestazione_anno}
                          {spostamento.ultima_attestazione_anno ? ` - ${spostamento.ultima_attestazione_anno}` : ""}
                          )
                        </>
                      )}
                    </h3>

                    {showDates && (
                      <div style={{ 
                        marginBottom: "8px",
                        fontSize: "14px",
                        color: "#666"
                      }}>
                        {primaData ? `Arrival date: ${primaData}` : "Arrival date: N.D."}
                        <br />
                        {ultimaData ? `Departure date: ${ultimaData}` : "Departure date: N.D."}
                      </div>
                    )}

                    {spostamento.spostato_in_qualita_di && (
                      <p style={{ fontSize: "16px", fontWeight: "bold", color: "#333", marginBottom: "6px" }}>
                        {spostamento.spostato_in_qualita_di}
                      </p>
                    )}

                    {spostamento.note_sullo_spostamento && (
                      <div
                        style={{
                          fontSize: "14px",
                          color: "#555",
                          lineHeight: "1.4",
                          maxWidth: "90%",
                          margin: "0 auto",
                        }}
                        dangerouslySetInnerHTML={{ __html: spostamento.note_sullo_spostamento }}
                      />
                    )}
                  </div>
                );
              })}
            </div>
          </div>
        </div>
      );
    }}
  </RecordContext.Consumer>
</Record>